{% extends "admin/admin_base.html" %}
{% load static %}

{% block title %}Add Category | Admin Panel{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/admin_css/list.css' %}">

<h1> Records details</h1>

<table border="1" cellpadding="5" cellspacing="0">
    <tr>
        <th>Sr. No.</th>
        <th>ID</th>
        <th>Product Name</th>
        <th>Category</th>
        <th>Subcategories</th>
        <th>Weights & Prices</th>
        <th>Images</th>
        <th>Description</th>
        <th>Action</th>
    </tr>

    {% for product in products %}
    <tr>
        <td>{{ forloop.counter }}</td> <!-- Serial number -->
        <td>{{ product.id }}</td>
        <td>{{ product.name }}</td>

        <!-- Category -->
        <td>
            {% if product.category %}
                {{ product.category.id }} - {{ product.category.category_name }}
            {% else %}
                -
            {% endif %}
        </td>

<!-- Subcategories -->
<td>
    {% if product.subcategories.exists %}
        {% for sub in product.subcategories.all %}
            {{ sub.id }} - {{ sub.name }}{% if not forloop.last %}, {% endif %}
        {% endfor %}
    {% else %}
        No subcategories
    {% endif %}
</td>

        <!-- Weights & Prices -->
        <td>
            {% for w in product.weights.all %}
                {{ w.weight }} - â‚¹{{ w.price }}<br>
            {% empty %}
                -
            {% endfor %}
        </td>

        <!-- Images -->
        <td>
            {% for img in product.images.all %}
                {% if img.is_main %}{% endif %}
                <img src="{{ img.image.url }}" width="50" height="50"><br>
            {% empty %}
                No image
            {% endfor %}
        </td>

        <!-- Description -->
        <td>{{ product.description }}</td>

        <!-- Action -->
        <td>
            <a href={% url "add_product" %}>Edit</a> |
            <a href="{% url 'delete_product' product.id %}" 
            onclick="return confirm('Are you sure you want to delete this product?');">
            Delete
            </a>
        </td>
    </tr>
    {% endfor %}
</table>


<!-- Similarly for subcategories, users, contacts -->
{% endblock %}